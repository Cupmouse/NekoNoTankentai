<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ws client test</title>
</head>
<body>

<div id="text">

</div>

<script type="application/javascript">
    let ws = new WebSocket('ws://localhost:8080/request');

    function log(text) {
        let element = document.getElementById("text");

        element.insertAdjacentHTML("afterbegin", text + "<br>");
    }

    ws.onmessage = function(event) {
        log(event.data);
    };

    ws.onopen = function () {
        request('block', ['number', '14703', 'all', 'all']);
        request('transaction', ['number_and_index', '14703', 0]);
        request('search', '147031');
        request('uncle', ['hash', '0xc8db2be0bc63f059bc5299675768327b10e741cfd27bd3f55d6ccc1eaf164c7b']);
    };

    ws.onclose = function () {
        log("closed");
    };

    let requestSeqId = 0;

    function request(demand, content) {
        let wrapped = {
            id: requestSeqId++,
            demand: demand,
            content: content
        };

        ws.send(JSON.stringify(wrapped));
    }

</script>
</body>
</html>