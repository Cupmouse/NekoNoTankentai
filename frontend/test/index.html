<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ws client test</title>
</head>
<body>

<div id="text">

</div>

<script type="application/javascript">
    let ws = new WebSocket('ws://localhost:8080/request');

    function log(text) {
        let element = document.getElementById("text");

        element.insertAdjacentHTML("afterbegin", text + "<br>");
    }

    ws.onmessage = function(event) {
        log(event.data);
    };

    ws.onopen = function () {
        request("search", {word: "0x734a6fc85f54e7e49394788aa7b228f68dff8951"});
    };

    ws.onclose = function () {
        log("closed");
    };

    let requestSeqId = 0;

    function request(demand, content) {
        let wrapped = {
            id: requestSeqId++,
            demand: demand,
            content: content
        };

        ws.send(JSON.stringify(wrapped));
    }

</script>
</body>
</html>